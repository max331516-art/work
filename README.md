# Воронка лидов — поиск работы (React + TypeScript)

Веб-приложение для сбора квалифицированных лидов по вакансиям с партнёрскими ссылками. Мультиязык (RU, UZ, TJ, KG, HI), адаптив, интеграция с Telegram WebApp.

---

## Что это

- **Стек:** Vite, React, TypeScript, Tailwind, shadcn/ui  
- **Сценарий:** язык → категория → **возраст** (при «Мне нет 18» — экран отказа) → город (при необходимости) → транспорт (для доставки) → документы → **когда готов выйти на работу** (с шансом отказа «нет вакансий») → список вакансий → форма заявки (имя, телефон) → экран успеха с паузой → редирект на партнёра (если прошло ≥30 сек и ≥3 шагов).  
- **Квалификация:** шаг возраста (если «Мне нет 18 лет» — отказ), шаг «Когда готовы выйти на работу?», валидация имени (только буквы, без цифр и символов), валидация российского телефона, проверка дубликатов по номеру при наличии бэкенда.
- **Фильтрация:** 20–30% пользователей после шага «Когда готовы выйти» случайно видят экран «К сожалению, сейчас нет подходящих вакансий» (имитация отбора).
- **Поведение:** перед редиректом — пауза 5–10 сек с текстом «Отправляем ваши данные работодателю…»; редирект выполняется только если пользователь провёл на сайте не менее 30 секунд и прошёл минимум 3 шага (антибот).

---

## Быстрый старт

```bash
# Установка зависимостей
npm i

# Запуск в режиме разработки
npm run dev

# Сборка для продакшена
npm run build
```

---

## Настройка перед запуском

1. **Партнёрские ссылки**  
   В `src/data/jobs.ts` замени `YOUR_REF` в полях `link` (и при необходимости `fallbackLink`) на свои реф-ссылки из CPA-сетей.

2. **Бэкенд (опционально)**  
   Если есть API для приёма лидов:
   - Создай файл `.env` в корне проекта.
   - Добавь строку: `VITE_BACKEND_URL=https://твой-бэкенд.example.com`  
   Без `VITE_BACKEND_URL` форма всё равно работает, но лиды не сохраняются и дубликаты не проверяются.

3. **Резервные офферы**  
   В `jobs.ts` у любой вакансии можно указать `fallbackLink`. С вероятностью 20% пользователь будет перенаправлен на него вместо основной ссылки (A/B или запасной партнёр).

---

## Структура проекта

- `src/pages/Index.tsx` — главная страница, шаги воронки  
- `src/hooks/useJobFinder.ts` — состояние и логика шагов (в т.ч. шаг `readyWhen`)  
- `src/components/ApplyForm.tsx` — форма заявки (валидация имени и телефона, отправка на бэкенд, передача ссылки для редиректа)
- `src/components/RejectionScreen.tsx` — экран отказа (возраст &lt;18 или «нет вакансий»)
- `src/components/SuccessScreen.tsx` — экран успеха с паузой и редиректом по таймеру  
- `src/components/StepQuestion.tsx` — шаг с выбором варианта  
- `src/data/jobs.ts` — вакансии по категориям и городам  
- `src/data/translations.ts` — тексты на 5 языках  

---

## Рекомендации перед запуском (через 2 дня)

### Обязательно

1. **Подставить свои реф-ссылки** во все вакансии в `src/data/jobs.ts`. Иначе трафик уйдёт «в никуда».  
2. **Проверить воронку на телефоне:** язык → категория → город → документы → **когда готов выйти** → вакансии → форма. Убедиться, что редирект открывается и что нет ошибок в консоли.  
3. **Если используешь бэкенд:** задеплоить его, в `.env` указать `VITE_BACKEND_URL`, после этого пересобрать фронт (`npm run build`). Иначе лиды не будут сохраняться и дубликаты не отсекутся.

### Желательно

4. **Один fallback на популярную вакансию** уже есть (Яндекс.Еда → Самокат). Для остальных топ-офферов при необходимости добавь `fallbackLink` в `jobs.ts`, чтобы не зависеть от одного партнёра.  
5. **Проверить тексты** на выбранном языке (особенно RU): шаг «Когда готовы выйти на работу?» и сообщения об ошибках (неверный телефон, дубликат).  
6. **Если бот в Telegram:** привязать WebApp к боту (Menu Button или кнопка в сообщении), чтобы `tg_id` передавался и в бэкенде можно было считать лиды по пользователям.

### Не забыть

7. **Деплой фронта:** Vercel / Netlify / любой хостинг для статики. Важно: при смене `VITE_BACKEND_URL` нужна новая сборка.  
8. **Первый день после запуска:** глянуть логи бэкенда и/или БД — приходят ли лиды, нет ли 409 (дубликаты), как ведёт себя редирект.  
9. **Метрики качества:** если бэкенд считает `lead_score` и `ready_when`, смотри, какая доля лидов «готов через 1–3 дня» и с документами — по ним ориентироваться при масштабировании трафика.

---

## Деплой

- **Фронт:** `npm run build` → залить содержимое `dist/` на хостинг или подключить репозиторий к Vercel/Netlify.  
- **Бэкенд:** отдельно (например FastAPI + SQLite), см. описание API в репозитории бэкенда. В приложении используется только `POST /api/leads` и ожидаются поля: `tg_id`, `language`, `city`, `documents`, `transport`, `category`, `job_company`, `phone`, `name`, `ready_when`, `source`, `is_converted`. Ответ 409 с `{ "duplicate": true }` обрабатывается как «такой номер уже оставлял заявку».

---

## Бот-напоминания (reminder_bot_v2.py)

Скрипт лежит в родительской папке HR6: `../reminder_bot_v2.py`. Подробное описание: как работает, что хорошо, что доработать — в файле **`../REMINDER_BOT_README.md`**. Важно: чтобы бот находил «недозаполненных» пользователей, бэкенд должен сохранять лида при входе в воронку (tg_id + язык/категория, без телефона), а не только при отправке формы.

---

## Лицензия

По усмотрению правообладателя.
